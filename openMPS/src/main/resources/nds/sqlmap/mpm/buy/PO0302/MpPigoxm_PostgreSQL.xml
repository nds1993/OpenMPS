<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="MpPigoxm">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="mpPigoxmSerarchVO" type="nds.mpm.buy.PO0302.vo.MpPigoxmVO"/>
	
	<resultMap id="mpPigoxm" class="nds.mpm.buy.PO0302.vo.MpPigoxmVO">
		<result property="corpCode" column="corp_code" columnIndex="1"/>
		<result property="dochDate" column="doch_date" columnIndex="2"/>
		<result property="procDate" column="proc_date" columnIndex="3"/>
		<result property="custCode" column="cust_code" columnIndex="4"/>
		<result property="partGubn" column="part_gubn" columnIndex="5"/>
		<result property="brandCode" column="brand_code" columnIndex="6"/>
		<result property="dochCnt" column="doch_cnt" columnIndex="7"/>
		<result property="deduAmt" column="dedu_amt" columnIndex="8"/>
		<result property="setlAmt" column="setl_amt" columnIndex="9"/>
		<result property="scraMeat" column="scra_meat" columnIndex="10"/>
		<result property="scraAmt" column="scra_amt" columnIndex="11"/>
		<result property="pigWeig" column="pig_weig" columnIndex="12"/>
		<result property="dispRate" column="disp_rate" columnIndex="13"/>
		<result property="othMeat" column="oth_meat" columnIndex="14"/>
		<result property="othAmt" column="oth_amt" columnIndex="15"/>
		<result property="cuseOccur" column="cuse_occur" columnIndex="16"/>
		<result property="occurQty" column="occur_qty" columnIndex="17"/>
		<result property="hindLeg" column="hind_leg" columnIndex="18"/>
		<result property="memo" column="memo" columnIndex="19"/>
		<result property="deleYn" column="dele_yn" columnIndex="20"/>
		<result property="mdUser" column="md_user" columnIndex="21"/>
		<result property="mdDate" column="md_date" columnIndex="22"/>
		<result property="crUser" column="cr_user" columnIndex="23"/>
		<result property="crDate" column="cr_date" columnIndex="24"/>
		<result property="buyType" column="buy_type" columnIndex="25"/>
		<result property="othQty" column="oth_qty" columnIndex="26"/>
		<result property="othDanga" column="oth_danga" columnIndex="27"/>
		<result property="othPart" column="oth_part" columnIndex="28"/>
	</resultMap>
	
	<select id="PO0302MpPigoxmDAO.selectMpPigoxmList_tab1" parameterClass="mpPigoxmSerarchVO" resultClass="egovMap">
	  SELECT	AA.DOCH_DATE,
				AA.CUST_CODE,
				AA.CUST_NAME,
				AA.BUY_TYPE,
				AA.BUY_TYPE_NAME,
				AA.BRAND_CODE,
				AA.BRAND_NAME,
				AA.OTH_KIND,
				AA.OTH_KIND_NAME,
				AA.OTH_PART,
				CASE WHEN AA.OTH_CAUSE1 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE2||AA.OTH_CAUSE3||AA.OTH_CAUSE4||AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
						= 'XXXXXXXX'	THEN BB.CODE_NAME	ELSE BB.CODE_NAME||','	END END ||
				CASE WHEN AA.OTH_CAUSE2 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE3||AA.OTH_CAUSE4||AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
						= 'XXXXXXX'		THEN CC.CODE_NAME	ELSE CC.CODE_NAME||','	END END ||
				CASE WHEN AA.OTH_CAUSE3 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE4||AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
						= 'XXXXXX'		THEN DD.CODE_NAME	ELSE DD.CODE_NAME||','	END END ||
				CASE WHEN AA.OTH_CAUSE4 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
						= 'XXXXX'		THEN EE.CODE_NAME	ELSE EE.CODE_NAME||','	END END ||			
				CASE WHEN AA.OTH_CAUSE5 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
						= 'XXXX'			THEN FF.CODE_NAME	ELSE FF.CODE_NAME||','	END END ||						
				CASE WHEN AA.OTH_CAUSE6 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
						= 'XXX'			THEN GG.CODE_NAME	ELSE GG.CODE_NAME||','	END END ||			
				CASE WHEN AA.OTH_CAUSE7 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE8||AA.OTH_CAUSE9
						= 'XX'			THEN HH.CODE_NAME	ELSE HH.CODE_NAME||','	END END ||			
				CASE WHEN AA.OTH_CAUSE8 = 'X' THEN '' ELSE 
					CASE WHEN AA.OTH_CAUSE9
						= 'X'			THEN II.CODE_NAME	ELSE II.CODE_NAME||','	END END	||			
				CASE WHEN AA.OTH_CAUSE9 = 'X' THEN '' ELSE JJ.CODE_NAME	END OTH_CAUSE_TEXT,			
				SUM(AA.OTH_QTY1)		OTH_QTY,
				MAX(AA.OTH_DANGA4)	    OTH_DANGA,
				SUM(AA.OTH_PRIC)		OTH_PRIC,
				SUM(AA.OTH_WEIG)		OTH_WEIG,
				SUM(AA.OTH_SISE)		OTH_SISE,
				SUM(AA.OTH_PER)		    OTH_PER,
				AA.MEMO			
	FROM(
	SELECT	A.DOCH_DATE,
				A.CUST_CODE,
				B.CUST_NAME,
				A.BUY_TYPE,
				C.CODE_NAME	BUY_TYPE_NAME,
				A.BRAND_CODE,
				D.CODE_NAME	BRAND_NAME,
				A.OTH_KIND,
				E.CODE_NAME	OTH_KIND_NAME,
				A.OTH_PART,
				CASE WHEN A.OTH_CAUSE1 = '1' THEN '1' ELSE 'X'	END OTH_CAUSE1,
				CASE WHEN A.OTH_CAUSE2 = '1' THEN '2' ELSE 'X'	END OTH_CAUSE2,
				CASE WHEN A.OTH_CAUSE3 = '1' THEN '3' ELSE 'X'	END OTH_CAUSE3,
				CASE WHEN A.OTH_CAUSE4 = '1' THEN '4' ELSE 'X'	END OTH_CAUSE4,
				CASE WHEN A.OTH_CAUSE5 = '1' THEN '5' ELSE 'X'	END OTH_CAUSE5,
				CASE WHEN A.OTH_CAUSE6 = '1' THEN '6' ELSE 'X'	END OTH_CAUSE6,
				CASE WHEN A.OTH_CAUSE7 = '1' THEN '7' ELSE 'X'	END OTH_CAUSE7,
				CASE WHEN A.OTH_CAUSE8 = '1' THEN '8' ELSE 'X'	END OTH_CAUSE8,
				CASE WHEN A.OTH_CAUSE9 = '1' THEN '9' ELSE 'X'	END OTH_CAUSE9,
				A.OTH_QTY1,
				A.OTH_DANGA4,
				A.OTH_PRIC,
				A.OTH_WEIG,
				A.OTH_SISE,
				A.OTH_PER,
				A.MEMO
	FROM	MP_PIGOXM A LEFT OUTER JOIN MP_CUST_INFO B
								ON		A.CUST_CODE	= B.CUST_CODE
							LEFT OUTER JOIN TM_CODEXD	C
								ON		A.BUY_TYPE	= C.CODE_ID
								AND	C.GROUP_CODE	= 'PP006'
							LEFT OUTER JOIN TM_CODEXD	D
								ON		A.BRAND_CODE	= D.CODE_ID
								AND	D.GROUP_CODE	= 'PP007'
							LEFT OUTER JOIN TM_CODEXD	E
								ON		A.OTH_KIND	= E.CODE_ID
							AND	E.GROUP_CODE	= 'PO004'
	WHERE	A.CORP_CODE	LIKE #corpCode#
	AND	A.DOCH_DATE	BETWEEN #strtDate# AND #lastDate#
	<isNotEmpty property="brandCode">
		AND A.BRAND_CODE = #brandCode# 
	</isNotEmpty>
	<isNotEmpty property="custCode">
		AND	A.CUST_CODE	like '%' || #custCode# || '%'
	</isNotEmpty> 
	<isNotEmpty property="othPart">
		AND	A.OTH_PART = #othPart#
	</isNotEmpty>  
	ORDER BY A.DOCH_DATE, A.CUST_CODE, A.BUY_TYPE, A.BRAND_CODE, A.OTH_KIND
	) AA	LEFT OUTER JOIN TM_CODEXD BB
				ON	AA.OTH_CAUSE1	= BB.CODE_ID
				AND	BB.GROUP_CODE	= 'PO006'
			LEFT OUTER JOIN TM_CODEXD CC
				ON	AA.OTH_CAUSE2	= CC.CODE_ID			
				AND	CC.GROUP_CODE	= 'PO006'
			LEFT OUTER JOIN TM_CODEXD DD
				ON	AA.OTH_CAUSE3	= DD.CODE_ID
				AND	DD.GROUP_CODE	= 'PO006'
			LEFT OUTER JOIN TM_CODEXD EE
				ON	AA.OTH_CAUSE4	= EE.CODE_ID						
				AND	EE.GROUP_CODE	= 'PO006'			
			LEFT OUTER JOIN TM_CODEXD FF
				ON	AA.OTH_CAUSE5	= FF.CODE_ID
				AND	FF.GROUP_CODE	= 'PO006'
			LEFT OUTER JOIN TM_CODEXD GG
				ON	AA.OTH_CAUSE6	= GG.CODE_ID			
				AND	GG.GROUP_CODE	= 'PO006'
			LEFT OUTER JOIN TM_CODEXD HH
				ON	AA.OTH_CAUSE7	= HH.CODE_ID
				AND	HH.GROUP_CODE	= 'PO006'
			LEFT OUTER JOIN TM_CODEXD II
				ON	AA.OTH_CAUSE8	= II.CODE_ID									
				AND	II.GROUP_CODE	= 'PO006'
			LEFT OUTER JOIN TM_CODEXD JJ
				ON	AA.OTH_CAUSE9	= JJ.CODE_ID
				AND	JJ.GROUP_CODE	= 'PO006'
	GROUP BY AA.DOCH_DATE,
				AA.CUST_CODE,
				AA.CUST_NAME,
				AA.BUY_TYPE,
				AA.BUY_TYPE_NAME,
				AA.BRAND_CODE,
				AA.BRAND_NAME,
				AA.OTH_KIND,
				AA.OTH_KIND_NAME,
				AA.OTH_PART,
				OTH_CAUSE_TEXT,
				AA.MEMO
	</select>	
	
	<select id="PO0302MpPigoxmDAO.selectMpPigoxmListTotCnt_tab1" parameterClass="mpPigoxmSerarchVO" resultClass="int">
		SELECT COUNT(A.*)
		  from (
				SELECT	AA.DOCH_DATE,
								AA.CUST_CODE,
								AA.CUST_NAME,
								AA.BUY_TYPE,
								AA.BUY_TYPE_NAME,
								AA.BRAND_CODE,
								AA.BRAND_NAME,
								AA.OTH_KIND,
								AA.OTH_KIND_NAME,
								AA.OTH_PART,
								CASE WHEN AA.OTH_CAUSE1 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE2||AA.OTH_CAUSE3||AA.OTH_CAUSE4||AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
										= 'XXXXXXXX'	THEN BB.CODE_NAME	ELSE BB.CODE_NAME||','	END END ||
								CASE WHEN AA.OTH_CAUSE2 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE3||AA.OTH_CAUSE4||AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
										= 'XXXXXXX'		THEN CC.CODE_NAME	ELSE CC.CODE_NAME||','	END END ||
								CASE WHEN AA.OTH_CAUSE3 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE4||AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
										= 'XXXXXX'		THEN DD.CODE_NAME	ELSE DD.CODE_NAME||','	END END ||
								CASE WHEN AA.OTH_CAUSE4 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE5||AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
										= 'XXXXX'		THEN EE.CODE_NAME	ELSE EE.CODE_NAME||','	END END ||			
								CASE WHEN AA.OTH_CAUSE5 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE6||AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
										= 'XXXX'			THEN FF.CODE_NAME	ELSE FF.CODE_NAME||','	END END ||						
								CASE WHEN AA.OTH_CAUSE6 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE7||AA.OTH_CAUSE8||AA.OTH_CAUSE9
										= 'XXX'			THEN GG.CODE_NAME	ELSE GG.CODE_NAME||','	END END ||			
								CASE WHEN AA.OTH_CAUSE7 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE8||AA.OTH_CAUSE9
										= 'XX'			THEN HH.CODE_NAME	ELSE HH.CODE_NAME||','	END END ||			
								CASE WHEN AA.OTH_CAUSE8 = 'X' THEN '' ELSE 
									CASE WHEN AA.OTH_CAUSE9
										= 'X'			THEN II.CODE_NAME	ELSE II.CODE_NAME||','	END END	||			
								CASE WHEN AA.OTH_CAUSE9 = 'X' THEN '' ELSE JJ.CODE_NAME	END OTH_CAUSE_TEXT,			
								SUM(AA.OTH_QTY1)		OTH_QTY,
								MAX(AA.OTH_DANGA4)	    OTH_DANGA,
								SUM(AA.OTH_PRIC)		OTH_PRIC,
								SUM(AA.OTH_WEIG)		OTH_WEIG,
								SUM(AA.OTH_SISE)		OTH_SISE,
								SUM(AA.OTH_PER)		    OTH_PER,
								AA.MEMO			
					FROM(
					SELECT	A.DOCH_DATE,
								A.CUST_CODE,
								B.CUST_NAME,
								A.BUY_TYPE,
								C.CODE_NAME	BUY_TYPE_NAME,
								A.BRAND_CODE,
								D.CODE_NAME	BRAND_NAME,
								A.OTH_KIND,
								E.CODE_NAME	OTH_KIND_NAME,
								A.OTH_PART,
								CASE WHEN A.OTH_CAUSE1 = '1' THEN '1' ELSE 'X'	END OTH_CAUSE1,
								CASE WHEN A.OTH_CAUSE2 = '1' THEN '2' ELSE 'X'	END OTH_CAUSE2,
								CASE WHEN A.OTH_CAUSE3 = '1' THEN '3' ELSE 'X'	END OTH_CAUSE3,
								CASE WHEN A.OTH_CAUSE4 = '1' THEN '4' ELSE 'X'	END OTH_CAUSE4,
								CASE WHEN A.OTH_CAUSE5 = '1' THEN '5' ELSE 'X'	END OTH_CAUSE5,
								CASE WHEN A.OTH_CAUSE6 = '1' THEN '6' ELSE 'X'	END OTH_CAUSE6,
								CASE WHEN A.OTH_CAUSE7 = '1' THEN '7' ELSE 'X'	END OTH_CAUSE7,
								CASE WHEN A.OTH_CAUSE8 = '1' THEN '8' ELSE 'X'	END OTH_CAUSE8,
								CASE WHEN A.OTH_CAUSE9 = '1' THEN '9' ELSE 'X'	END OTH_CAUSE9,
								A.OTH_QTY1,
								A.OTH_DANGA4,
								A.OTH_PRIC,
								A.OTH_WEIG,
								A.OTH_SISE,
								A.OTH_PER,
								A.MEMO
					FROM	MP_PIGOXM A LEFT OUTER JOIN MP_CUST_INFO B
												ON		A.CUST_CODE	= B.CUST_CODE
											LEFT OUTER JOIN TM_CODEXD	C
												ON		A.BUY_TYPE	= C.CODE_ID
												AND	C.GROUP_CODE	= 'PP006'
											LEFT OUTER JOIN TM_CODEXD	D
												ON		A.BRAND_CODE	= D.CODE_ID
												AND	D.GROUP_CODE	= 'PP007'
											LEFT OUTER JOIN TM_CODEXD	E
												ON		A.OTH_KIND	= E.CODE_ID
											AND	E.GROUP_CODE	= 'PO004'
					WHERE	A.CORP_CODE	LIKE #corpCode#
					AND	A.DOCH_DATE	BETWEEN #strtDate# AND #lastDate#
					<isNotEmpty property="brandCode">
						AND A.BRAND_CODE = #brandCode# 
					</isNotEmpty> 
					<isNotEmpty property="custCode">
						AND	A.CUST_CODE	like '%' || #custCode# || '%'
					</isNotEmpty> 
					<isNotEmpty property="othPart">
						AND	A.OTH_PART = #othPart#
					</isNotEmpty>  
					ORDER BY A.DOCH_DATE, A.CUST_CODE, A.BUY_TYPE, A.BRAND_CODE, A.OTH_KIND
					) AA	LEFT OUTER JOIN TM_CODEXD BB
								ON	AA.OTH_CAUSE1	= BB.CODE_ID
								AND	BB.GROUP_CODE	= 'PO006'
							LEFT OUTER JOIN TM_CODEXD CC
								ON	AA.OTH_CAUSE2	= CC.CODE_ID			
								AND	CC.GROUP_CODE	= 'PO006'
							LEFT OUTER JOIN TM_CODEXD DD
								ON	AA.OTH_CAUSE3	= DD.CODE_ID
								AND	DD.GROUP_CODE	= 'PO006'
							LEFT OUTER JOIN TM_CODEXD EE
								ON	AA.OTH_CAUSE4	= EE.CODE_ID						
								AND	EE.GROUP_CODE	= 'PO006'			
							LEFT OUTER JOIN TM_CODEXD FF
								ON	AA.OTH_CAUSE5	= FF.CODE_ID
								AND	FF.GROUP_CODE	= 'PO006'
							LEFT OUTER JOIN TM_CODEXD GG
								ON	AA.OTH_CAUSE6	= GG.CODE_ID			
								AND	GG.GROUP_CODE	= 'PO006'
							LEFT OUTER JOIN TM_CODEXD HH
								ON	AA.OTH_CAUSE7	= HH.CODE_ID
								AND	HH.GROUP_CODE	= 'PO006'
							LEFT OUTER JOIN TM_CODEXD II
								ON	AA.OTH_CAUSE8	= II.CODE_ID									
								AND	II.GROUP_CODE	= 'PO006'
							LEFT OUTER JOIN TM_CODEXD JJ
								ON	AA.OTH_CAUSE9	= JJ.CODE_ID
								AND	JJ.GROUP_CODE	= 'PO006'
					GROUP BY AA.DOCH_DATE,
								AA.CUST_CODE,
								AA.CUST_NAME,
								AA.BUY_TYPE,
								AA.BUY_TYPE_NAME,
								AA.BRAND_CODE,
								AA.BRAND_NAME,
								AA.OTH_KIND,
								AA.OTH_KIND_NAME,
								AA.OTH_PART,
								OTH_CAUSE_TEXT,
								AA.MEMO		  
		  ) A
	</select>
	
	<select id="PO0302MpPigoxmDAO.selectMpPigoxmList_tab2" parameterClass="mpPigoxmSerarchVO" resultClass="egovMap">
	SELECT	ROW_NUMBER () OVER (ORDER BY  A.PART_GUBN, A.DOCH_DATE, A.PROC_DATE, A.CUST_CODE)	SEQ,
				A.DOCH_DATE,
				A.PROC_DATE,
				A.CUST_CODE,
				B.CUST_NAME,
				A.BUY_TYPE,
				C.CODE_NAME	BUY_TYPE_NAME,
				A.BRAND_CODE,
				D.CODE_NAME	BRAND_NAME,
				A.DOCH_CNT,
				A.DEDU_AMT,
				A.SETL_AMT,
				A.PART_GUBN,
				E.CODE_NAME,
				A.SCRA_MEAT,
				A.SCRA_AMT,
				A.PIG_WEIG,
				A.DISP_RATE,
				A.OTH_MEAT,
				A.OTH_AMT,
				A.CUSE_OCCUR,
				A.OCCUR_QTY,
				A.HIND_LEG,
				A.MEMO
	FROM	MP_PIGXXD A	LEFT OUTER JOIN MP_CUST_INFO B
								ON		A.CUST_CODE	= B.CUST_CODE
							LEFT OUTER JOIN TM_CODEXD	C
								ON		A.BUY_TYPE	= C.CODE_ID
								AND	C.GROUP_CODE	= 'PP006'
							LEFT OUTER JOIN TM_CODEXD	D
								ON		A.BRAND_CODE	= D.CODE_ID
								AND	D.GROUP_CODE	= 'PP007'
							LEFT OUTER JOIN TM_CODEXD	E
								ON		A.PART_GUBN	= E.CODE_ID
							AND	E.GROUP_CODE	= 'PO007'
	WHERE	A.CORP_CODE	LIKE #corpCode#
	AND	A.DOCH_DATE	BETWEEN #strtDate# AND #lastDate#
	<isNotEmpty property="brandCode">
		AND A.BRAND_CODE = #brandCode# 
	</isNotEmpty> 
	<isNotEmpty property="custCode">
		AND	A.CUST_CODE	like '%' || #custCode# || '%'
	</isNotEmpty>
	ORDER BY A.PART_GUBN, A.DOCH_DATE, A.PROC_DATE, A.CUST_CODE	
	</select>	
	
	<select id="PO0302MpPigoxmDAO.selectMpPigoxmListTotCnt_tab2" parameterClass="mpPigoxmSerarchVO" resultClass="int">
		SELECT  COUNT(A.*)		
		  from 
				(SELECT	ROW_NUMBER () OVER (ORDER BY  A.PART_GUBN, A.DOCH_DATE, A.PROC_DATE, A.CUST_CODE)	SEQ,
								A.DOCH_DATE,
								A.PROC_DATE,
								A.CUST_CODE,
								B.CUST_NAME,
								A.BUY_TYPE,
								C.CODE_NAME	BUY_TYPE_NAME,
								A.BRAND_CODE,
								D.CODE_NAME	BRAND_NAME,
								A.DOCH_CNT,
								A.DEDU_AMT,
								A.SETL_AMT,
								A.PART_GUBN,
								E.CODE_NAME,
								A.SCRA_MEAT,
								A.SCRA_AMT,
								A.PIG_WEIG,
								A.DISP_RATE,
								A.OTH_MEAT,
								A.OTH_AMT,
								A.CUSE_OCCUR,
								A.OCCUR_QTY,
								A.HIND_LEG,
								A.MEMO
					FROM	MP_PIGXXD A	LEFT OUTER JOIN MP_CUST_INFO B
												ON		A.CUST_CODE	= B.CUST_CODE
											LEFT OUTER JOIN TM_CODEXD	C
												ON		A.BUY_TYPE	= C.CODE_ID
												AND	C.GROUP_CODE	= 'PP006'
											LEFT OUTER JOIN TM_CODEXD	D
												ON		A.BRAND_CODE	= D.CODE_ID
												AND	D.GROUP_CODE	= 'PP007'
											LEFT OUTER JOIN TM_CODEXD	E
												ON		A.PART_GUBN	= E.CODE_ID
											AND	E.GROUP_CODE	= 'PO007'
					WHERE	A.CORP_CODE	LIKE #corpCode#
					AND	A.DOCH_DATE	BETWEEN #strtDate# AND #lastDate#
					<isNotEmpty property="brandCode">
						AND A.BRAND_CODE = #brandCode# 
					</isNotEmpty> 
					<isNotEmpty property="custCode">
						AND	A.CUST_CODE	like '%' || #custCode# || '%'
					</isNotEmpty>
					ORDER BY A.PART_GUBN, A.DOCH_DATE, A.PROC_DATE, A.CUST_CODE) A
	</select>

</sqlMap>
