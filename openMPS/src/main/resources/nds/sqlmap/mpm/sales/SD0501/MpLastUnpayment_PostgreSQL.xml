<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="MpLastUnpayment">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="mpLastUnpaymentSerarchVO" type="nds.mpm.sales.SD0501.vo.MpLastUnpaymentVO"/>
	
	<resultMap id="mpLastUnpayment" class="nds.mpm.sales.SD0501.vo.MpLastUnpaymentVO">
		<result property="corpCode" column="corp_code" columnIndex="1"/>
		<result property="unpayYymm" column="unpay_yymm" columnIndex="2"/>
		<result property="custCode" column="cust_code" columnIndex="3"/>
		<result property="lastUnpay" column="last_unpay" columnIndex="4"/>
		<result property="currentUnpay" column="current_unpay" columnIndex="5"/>
		<result property="headCust" column="head_cust" columnIndex="6"/>
	</resultMap>
	
	<insert id="mpLastUnpaymentDAO.insertMpLastUnpayment">
		<![CDATA[
			INSERT INTO mp_last_unpayment 
				( corp_code
				  , unpay_yymm
				  , cust_code
				  , last_unpay
				  , current_unpay
				  , head_cust )
			VALUES ( #corpCode#
				  , #unpayYymm#
				  , #custCode#
				  , #lastUnpay#
				  , #currentUnpay#
				  , #headCust# )
		]]>
	</insert>
	
	<update id="mpLastUnpaymentDAO.updateMpLastUnpayment">
		<![CDATA[
			UPDATE mp_last_unpayment
			SET corp_code=#corpCode#
				, unpay_yymm=#unpayYymm#
				, cust_code=#custCode#
				, last_unpay=#lastUnpay#
				, current_unpay=#currentUnpay#
				, head_cust=#headCust#
						WHERE corp_code=#corpCode#
								AND unpay_yymm=#unpayYymm#
								AND cust_code=#custCode#
				]]>
	</update>
	
	<update id="mpLastUnpaymentDAO.updateMpLastCurrentUnpayment">
		<![CDATA[
			UPDATE mp_last_unpayment
			SET current_unpay=(last_unpay - #currentUnpay#::numeric)
			WHERE corp_code=#corpCode#
					AND unpay_yymm=#unpayYymm#
					AND cust_code=#custCode#
				]]>
	</update>
	
	<delete id="mpLastUnpaymentDAO.deleteMpLastUnpayment">
		<![CDATA[
			DELETE FROM mp_last_unpayment 
						WHERE corp_code=#corpCode#
								AND unpay_yymm=#unpayYymm#
								AND cust_code=#custCode#
				]]>
	</delete>
	
	<select id="mpLastUnpaymentDAO.selectMpLastUnpayment_S" resultMap="mpLastUnpayment">
		<![CDATA[
			SELECT
				corp_code
				, unpay_yymm
				, cust_code
				, last_unpay
				, current_unpay
				, head_cust
			FROM mp_last_unpayment
						WHERE corp_code=#corpCode#
								AND unpay_yymm=#unpayYymm#
								AND cust_code=#custCode#
				]]>
	</select>
	
	<select id="mpLastUnpaymentDAO.selectMpLastUnpaymentList_D" parameterClass="mpLastUnpaymentSerarchVO" resultClass="egovMap">

	</select>	
	<select id="mpLastUnpaymentDAO.selectMpLastUnpaymentListTotCnt_S" parameterClass="mpLastUnpaymentSerarchVO" resultClass="int">

	</select>

</sqlMap>
