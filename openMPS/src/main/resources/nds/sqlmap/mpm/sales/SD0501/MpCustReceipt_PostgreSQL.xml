<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="MpCustReceipt">
	
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="mpCustReceiptSerarchVO" type="nds.mpm.sales.SD0501.vo.MpCustReceiptVO"/>
	
	<resultMap id="mpCustReceipt" class="nds.mpm.sales.SD0501.vo.MpCustReceiptVO">
		<result property="corpCode" column="corp_code" columnIndex="1"/>
		<result property="receDate" column="rece_date" columnIndex="2"/>
		<result property="custCode" column="cust_code" columnIndex="3"/>
		<result property="receType" column="rece_type" columnIndex="4"/>
		<result property="receAmt" column="rece_amt" columnIndex="5"/>
		<result property="headCust" column="head_cust" columnIndex="6"/>
	</resultMap>
	
	<insert id="mpCustReceiptDAO.insertMpCustReceipt">
		<selectKey resultClass="java.lang.String" keyProperty="receDate">
          <![CDATA[
            select #receDate#
          ]]>
      	</selectKey>
		<![CDATA[
			INSERT INTO mp_cust_receipt 
				( corp_code
				  , rece_date
				  , cust_code
				  , rece_type
				  , rece_amt
				  , head_cust )
			VALUES ( #corpCode#
				  , #receDate#
				  , #custCode#
				  , #receType#
				  , #receAmt#
				  , #headCust# )
			ON CONFLICT (corp_code, rece_date, cust_code)
    		DO UPDATE SET
				rece_amt=#receAmt#
				, rece_type = #receType#
				, head_cust=#headCust#
		]]>
	</insert>
	
	<update id="mpCustReceiptDAO.updateMpCustReceipt">
		<![CDATA[
			UPDATE mp_cust_receipt
			SET rece_type=#receType#
				, rece_amt=#receAmt#
				, head_cust=#headCust#
						WHERE corp_code=#corpCode#
								AND rece_date=#receDate#
								AND cust_code=#custCode#
				]]>
	</update>
	
	<delete id="mpCustReceiptDAO.deleteMpCustReceipt">
		<![CDATA[
			DELETE FROM mp_cust_receipt 
						WHERE corp_code=#corpCode#
								AND rece_date=#receDate#
								AND cust_code=#custCode#
								AND rece_type=#receType#
				]]>
	</delete>
	
	<select id="mpCustReceiptDAO.selectMpCustReceipt_S" resultMap="mpCustReceipt">
		<![CDATA[
			SELECT
				corp_code
				, rece_date
				, cust_code
				, rece_type
				, rece_amt
				, head_cust
			FROM mp_cust_receipt
						WHERE corp_code=#corpCode#
								AND rece_date=#receDate#
								AND cust_code=#custCode#
								AND rece_type=#receType#
				]]>
	</select>
	
	<select id="mpCustReceiptDAO.selectMpCustReceiptMonthSum" resultClass="int">
		select coalesce(sum(rece_amt),0) as month_sum
		from mp_cust_receipt 
		where corp_code = #corpCode#
		and rece_date between #strtDate# and #lastDate#
		and cust_code = #custCode#
	</select>
	
	<select id="mpCustReceiptDAO.selectMpCustReceiptList_D" parameterClass="mpCustReceiptSerarchVO" resultClass="egovMap">

	</select>	
	<select id="mpCustReceiptDAO.selectMpCustReceiptListTotCnt_S" parameterClass="mpCustReceiptSerarchVO" resultClass="int">

	</select>

</sqlMap>
